!function(e,t){if("function"==typeof define&&define.amd)define("pacto/model",["exports","pacto"],t);else if("undefined"!=typeof exports)t(exports,require("pacto"));else{var n={};t(n,e.pacto),e.pactoModel=n}}(this,function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Model=e.Collection=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=new WeakMap,s=function(e){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};i(this,n);var o=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));e=r({},o.defaults,e);var t=new Proxy(e,{set:function(e,t,n){var r=e[t]!==n;return e[t]=n,r&&o.trigger("change",{prop:t,value:n}),!0}});return u.set(o,t),o}return c(n,t.EventEmitter),o(n,[{key:"defaults",get:function(){return null}},{key:"props",get:function(){return u.get(this)}}]),n}(),l=new WeakMap,n=function(e){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];i(this,r);var u=a(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),f=function(e){return e instanceof s?e:new u.Model(e)},t={get:function(i,a){var c=i[a];return"function"==typeof c?function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,o=!1;switch(a){case"pop":case"reverse":case"shift":case"sort":o=!0;break;case"fill":o=!0,t[0]=f(t[0]);break;case"push":case"unshift":o=!0,t=t.map(f);break;case"splice":o=!0,t=t.map(function(e,t){return 1<t?f(e):e})}return r=c.apply(i,t),o&&u.trigger("change",{method:a}),r}:c}},n=new Proxy(e.map(f),t);return l.set(u,n),u}return c(r,t.EventEmitter),o(r,[{key:"Model",get:function(){return s}},{key:"models",get:function(){return l.get(this)}}]),r}();e.Collection=n,e.Model=s});